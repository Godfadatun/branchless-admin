<template>
  <div>
    <q-card flat dark class="bg-transparent">
      <div class="column flex-center">
        <img src="statics/branchlessLogoWhite.png" style="max-width: 300px">
      </div>

      <q-card-section class="q-gutter-sm">
        <q-input dark outlined dense rounded v-model="form.email" label="Enter username" >
          <template v-slot:prepend>
            <div class="row flex-center">
              <q-icon name="ion-ios-person" />
              <div class="q-px-sm">|</div>
            </div>
          </template>
        </q-input>
        <q-input dark outlined dense rounded v-model="form.password" label="Enter Your Password" >
          <template v-slot:prepend>
            <q-icon name="ion-unlock" />
            <div class="q-px-sm">|</div>
          </template>
        </q-input>

      </q-card-section>
      <q-card-section>
        <q-btn rounded color="primary" @click="login()" no-caps label="Login" class="full-width" :loading="loading">
          <template v-slot:loading class="text-italic">
            <q-spinner-gears class="on-left" />
           ..login in
          </template>
        </q-btn>
      </q-card-section>
    </q-card>
  </div>
</template>

<script>
export default {
  // name: 'ComponentName',
  data () {
    return {
      loading: false,
      form:{
        email: '',
        password: ''
      }
    }
  },

  methods: {
    async login(){
      try {
        this.loading = true;
        const res = this.$axiosadmin.post('http://localhost:1337/auth/local',
            {
              'identifier': this.form.email,
              'password': this.form.password
            },
            {
              headers:{ Authorization: ''}
            }
        )
        this.loading = false;
        await this.$store.dispatch('DataAuth/login');
        this.$router.push({name: 'analytics'});
      } catch (error) {
        this.loading = false;
      }

    }
  },
}
</script>
